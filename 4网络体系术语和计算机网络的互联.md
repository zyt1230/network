 

一、IP地址
------

### 1、IP地址的定义

现在有2种IP地址，IPv4和[IPv6](https://so.csdn.net/so/search?q=IPv6&spm=1001.2101.3001.7020)。IPv4是当前广泛使用的，IPv6是正在扩展中的。  
IPv4有32位正整数的二进制表示。  
例如：  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/ddb7d538eea7446183ad00b73292cd09.png#pic_center)

> IP不是以主机的个数来配置的，而是根据设备上的**网卡（NIC）进行配置**，每一块网卡都会设置**一个或多个IP地址**。  
> **一个路由器可以包含多个IP地址**

### 2、IPv4的分类编址方法

*   网络层如何识别一个设备的信息，就像人一样，有身份证来查。

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/e6fc31a94358444797fa203116407f9e.png#pic_center)

*   网络号和主机号管理的方式  
    ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/e1dc0126588a4195b2371027e3281956.png#pic_center)
    
    > A、B、C类地址都是单播地址，只有单播地址可以分配给网络中的主机（或路由器）的各接口。  
    > 主机号为“全0”的地址是`网络地址`，不能分配给主机（或路由器）的各接口。  
    > 主机号为“全1”的地址是`广播地址`，不能分配给主机（或路由器）的各接口。
    

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/6f3272dae62e436eae943e992583e0f0.png#pic_center)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/0a3e80a88b79426b93f59511bca6d228.png#pic_center)

随着更多的中小网络加入因特网，IPv4分类编址方法不够灵活、容易造成大量[IPv4地址](https://so.csdn.net/so/search?q=IPv4%E5%9C%B0%E5%9D%80&spm=1001.2101.3001.7020)资源浪费的 缺点就暴露出来了。分类编址方法不够灵活且容易造成大量地址浪费，划分子网编址方法对其进行改进 （“打补丁”）。

*   与IPv4地址类似，子网掩码也是由32比特构成的。
    *   用左起多个连续的比特1对应IPv4地址中的网络号和子网号；
    *   之后的多个连续的比特0对应IPv4地址中的主机号。

### 3、IPv4划分子网编址的方法

#### 3.1、**确定需求**

*   **子网数量**：需要划分多少个子网。
*   **每个子网的主机数量**：每个子网需要支持多少台设备。

* * *

#### 3.2、 **了解IP地址和子网掩码**

*   **IP地址**：由网络号和主机号组成。
    
*   **子网掩码**：用于区分网络号和主机号，由连续的 `1` 和 `0` 组成。
    
    *   例如，`255.255.255.0`（或 `/24`）表示前24位是网络号，后8位是主机号。

* * *

#### 3.3、 **选择子网掩码**

*   根据子网数量和每个子网的主机数量选择合适的子网掩码。
    
*   使用公式计算：
    
    *   **子网数量**：`2^n`，其中 `n` 是子网掩码中借用的主机位数。
    *   **主机数量**：`2^m - 2`，其中 `m` 是剩余的主机位数（减去2是因为网络地址和广播地址不能用于主机）。

* * *

#### 3.4、 **划分子网的步骤**

[在线工具](https://tool.chinaz.com/tools/subnetmask)

##### 示例：将 `192.168.1.0/24` 划分为4个子网，每个子网至少支持50台主机。

1.  **确定子网数量**：
    
    *   需要4个子网，`2^2 = 4`，所以需要借用2位主机位。
2.  **确定新的子网掩码**：
    
    *   原掩码为 `/24`，借用2位后，新掩码为 `/26`（`24 + 2`）。
    *   子网掩码为 `255.255.255.192`。
3.  **计算每个子网的地址范围**：
    
    *   每个子网的主机位数为 `32 - 26 = 6`，每个子网支持 `2^6 - 2 = 62` 台主机。
        
    *   子网地址范围：
        
        *   子网1：`192.168.1.0/26`（`192.168.1.0` 到 `192.168.1.63`）
        *   子网2：`192.168.1.64/26`（`192.168.1.64` 到 `192.168.1.127`）
        *   子网3：`192.168.1.128/26`（`192.168.1.128` 到 `192.168.1.191`）
        *   子网4：`192.168.1.192/26`（`192.168.1.192` 到 `192.168.1.255`）
4.  **分配子网**：
    
    *   将每个子网分配给不同的部门或用途。

### 4、IPv4地址的无分类编址方法

IPv4地址的无分类编址方法（Classless Inter-Domain Routing，CIDR）是一种灵活的地址分配方式，用于替代传统的分类编址（Classful Addressing）。CIDR通过可变长度子网掩码（VLSM）实现更高效的地址分配，减少浪费。

#### 4.1、关键概念

1.  **CIDR表示法**：
    
    *   格式：`IP地址/前缀长度`
    *   示例：`192.168.1.0/24`，表示前24位为网络部分，后8位为主机部分。
2.  **前缀长度**：
    
    *   表示网络部分的位数，决定了网络的大小。
    *   前缀长度越长，网络越小，主机数量越少。
3.  **子网掩码**：
    
    *   用于区分网络和主机部分。
    *   示例：`/24`对应的子网掩码为`255.255.255.0`。
4.  **地址块大小**：
    
    *   可用主机数 = 2(32−前缀长度)−22(32−前缀长度)−2（减去网络地址和广播地址）。
    *   示例：`/24`有256个地址，254个可用主机。

#### 4.2、优点

*   **高效利用地址**：减少地址浪费。
*   **灵活分配**：适应不同规模的网络需求。
*   **路由聚合**：简化路由表，提高效率

二、超网
----

构造超网（Supernetting）是将**多个连续的较小网络合并为一个更大的网络的过程**。这一过程通常用于**减少路由表中的条目数量，从而优化路由效率**。

### 1、合并子网的核心计算步骤

1.  **确认子网的连续性**：
    
    *   子网的地址范围必须是连续的。
    *   例如，`192.168.0.0/24` 和 `192.168.1.0/24` 是连续的。
2.  **检查子网的前缀长度**：
    
    *   所有子网的前缀长度必须相同。
    *   例如，`/24` 的子网只能与其他 `/24` 的子网合并。
3.  **确定合并后的前缀长度**：
    
    *   合并后的前缀长度比原子网的前缀长度更短。
    *   每减少1位前缀长度，网络规模扩大一倍。
    *   公式：新前缀长度=原子网前缀长度−log⁡2(子网数量)新前缀长度=原子网前缀长度−log2​(子网数量)
4.  **验证二进制对齐**：
    
    *   子网的地址范围必须在二进制边界上对齐。
    *   例如，`192.168.0.0/24` 和 `192.168.1.0/24` 可以合并，因为它们在二进制边界上对齐。
5.  **计算合并后的网络地址**：
    
    *   合并后的网络地址是第一个子网的网络地址。
    *   例如，`192.168.0.0/24` 和 `192.168.1.0/24` 合并为 `192.168.0.0/23`。
6.  **验证合并后的地址范围**：
    
    *   确保合并后的地址范围覆盖所有原子网的地址范围。

* * *

### 2、合并子网的具体计算方法

##### 示例 1：合并两个 `/24` 子网

*   子网1：`192.168.0.0/24`
*   子网2：`192.168.1.0/24`

**步骤**：

1.  **确认连续性**：
    
    *   `192.168.0.0/24` 的范围是 `192.168.0.0` 到 `192.168.0.255`。
    *   `192.168.1.0/24` 的范围是 `192.168.1.0` 到 `192.168.1.255`。
    *   两个子网是连续的。
2.  **检查前缀长度**：
    
    *   两个子网的前缀长度均为 `/24`。
3.  **确定合并后的前缀长度**：
    
    *   子网数量为 2，因此：  
        新前缀长度=24−log⁡2(2)=24−1=23新前缀长度=24−log2​(2)=24−1=23
        
    *   合并后的前缀长度为 `/23`。
        
4.  **验证二进制对齐**：
    
    *   将 `192.168.0.0` 和 `192.168.1.0` 转换为二进制：
        
        *   `192.168.0.0`：`11000000.10101000.00000000.00000000`
        *   `192.168.1.0`：`11000000.10101000.00000001.00000000`
    *   前23位相同，符合二进制对齐。
        
5.  **计算合并后的网络地址**：
    
    *   合并后的网络地址是第一个子网的网络地址：`192.168.0.0/23`。
6.  **验证地址范围**：
    
    *   `192.168.0.0/23` 的范围是 `192.168.0.0` 到 `192.168.1.255`，覆盖了两个子网。

**结果**：

*   合并后的超网：`192.168.0.0/23`。

* * *

##### 示例 2：合并四个 `/25` 子网

*   子网1：`192.168.0.0/25`
*   子网2：`192.168.0.128/25`
*   子网3：`192.168.1.0/25`
*   子网4：`192.168.1.128/25`

**步骤**：

1.  **确认连续性**：
    
    *   四个子网的地址范围是连续的。
2.  **检查前缀长度**：
    
    *   所有子网的前缀长度均为 `/25`。
3.  **确定合并后的前缀长度**：
    
    *   子网数量为 4，因此：  
        新前缀长度=25−log⁡2(4)=25−2=23新前缀长度=25−log2​(4)=25−2=23
        
    *   合并后的前缀长度为 `/23`。
        
4.  **验证二进制对齐**：
    
    *   将 `192.168.0.0` 和 `192.168.1.128` 转换为二进制：
        
        *   `192.168.0.0`：`11000000.10101000.00000000.00000000`
        *   `192.168.1.128`：`11000000.10101000.00000001.10000000`
    *   前23位相同，符合二进制对齐。
        
5.  **计算合并后的网络地址**：
    
    *   合并后的网络地址是第一个子网的网络地址：`192.168.0.0/23`。
6.  **验证地址范围**：
    
    *   `192.168.0.0/23` 的范围是 `192.168.0.0` 到 `192.168.1.255`，覆盖了四个子网。

**结果**：

*   合并后的超网：`192.168.0.0/23`。

三、路由聚合
------

### 1\. 定义

路由聚合通过将多**个连续的子网合并为一个更大的网络地址块，减少路由表中的条目数量**。将多个路由条目合并为一个更通用的条目。

### 2\. 目的

减少路由表大小：降低内存和CPU消耗。

提高路由效率：加快路由查找速度。

简化网络管理：降低配置和维护复杂度。

### 3\. 工作原理

CIDR（无类别域间路由）：支持将多个IP地址块合并为一个。  
最长前缀匹配：路由器根据最长匹配原则选择最佳路由。

### 4.示例解析过程

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/dffabb0f01f941edbaa7837df8878466.png)

### 5.如何判断是子网还是超网

*   先判断该网段的类型，是A类、B类、C类网络
*   默认A类子网掩码的位数是8，B类子网掩码的位数是16，C类⼦网掩码的位数是24
*   然后判断子网掩码的位数
    *   比默认子网掩码**多**，就是**子网**
    *   比默认子网掩码**少**，就是**超网**

### 6、区分超网和路由聚合

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/7f3be53922524256ab9f078210b64199.png)

本文转自 <https://blog.csdn.net/2401_82911768/article/details/145693304?spm=1001.2014.3001.5502>，如有侵权，请联系删除。