一、链路层的概述
--------

* **链路**是指：⼀个节点到相邻节点的⼀段物理线路（有线或无线），**而中间没有任何其他的交换节点**。
* **数据链路**（Data Link）是**基于链路的**。当在⼀条链路上传送数据时，除需要链路本身，还**需要⼀些必要的通信协议来控制这些数据的传输**，把实现这些协议的硬件和软件加到链路上，就构成了数据链路。
* 不同类型的数据链路，所用的通信协议可能是不同的
  * **广播信道**：CSMA/CD协议（比如同轴电缆、集线器等组成的网络）
  * **点对点信道**：PPP协议（比如2个路由器之间的信道）
* **网络适配器（网卡）**和其相应的**软件驱动程序**就**实现了这些协议**。⼀般的**网络适配器都包含了物理层和数据链路层这两层的功能**。

二、[数据链路层](https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82&spm=1001.2101.3001.7020)的3个问题
---------------------------------------------------------------------------------------------------------------------

### 1、封装成帧

* **封装成帧**是指数据链路层给上层交付下来的协议数据单元[PDU](https://so.csdn.net/so/search?q=PDU&spm=1001.2101.3001.7020)添加⼀个首部和⼀个尾部，使之成为帧。
  
  * 帧的首部和尾部中包含有**⼀些重要的控制信息**。
  * 帧首部和尾部的作用之⼀就是**帧定界**。
  * **并不是每⼀种数据链路层协议的帧都包含有帧定界标志**。

* **帧（Frame）的数据部分**，就是[网络层](https://so.csdn.net/so/search?q=%E7%BD%91%E7%BB%9C%E5%B1%82&spm=1001.2101.3001.7020)传递下来的数据包（IP数据报）

* MTU（**最大传输单元**）
  
  * 每⼀种数据链路层协议都规定了所能传送的**帧的数据部分长度上限**。
  * **46字节**<=MTU<=**1500字节**（如果大于1500就需要拆数据包，把它们分小）
  * 所以帧最短有64字节  
    ![帧](https://i-blog.csdnimg.cn/direct/ac80b96a2f834f3e839115c1f5deeef1.png)

* 以太网V2的MAC帧  
  ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/ab3f74c573194360a242a9bdeb9b89ad.png)  
  ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/3a13d039ffb9432b8939022a691fbf43.png)  
  ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/7eeca703fcc449a5ad383d0e167d1d53.png)

* PPP帧

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/a387b77a87064e52b81a46ddb97d6ab8.png)  
![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/5bbd6673fccb4b8ca5e49289b07e2fd9.png)

### 2、透明传输

#### 2.1 定义

透明传输是指数据链路层对上层交付下来的协议数据单元PDU没有任何限制（**数据在传输过程中不被修改**），就好像数据链路层不存在⼀样。

#### 2.2 实现方式

可以使用**字节填充**的方法实现透明传输。

* 字节填充通过在数据中插入**转义字符**来实现透明传输，**确保特殊字符不被误解**。（可以理解成，如果用c语言打印 \\ ，会发现不能直接打印出来，因为它是注释的标志，但是写成 \\\\ ）  
  ![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/f2ba426ae8e24007bbae42050ee05da4.png)
* SOH（Start of Header，**头开始**）和EOT（End of Transmission，**传输结束**）是控制字符，用于数据通信中标记数据的开始和结束。它们在透明传输中尤为重要，确保数据帧的完整性和正确解析。
* 根据上图来理解，字节填充。假设：先从SOH读，在原始数据里出现了EOT，那么计算机读这段数据的时候会提前结束。所以需要用到字节填充。

### 3、差错控制

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/9b5518286bb14e29b93bb02a851de23d.png)  
FCS是根据数据部分 + 首部计算得出的 。

> 检错：方法一：奇偶检验 方法二：CRC循环冗余  
> 纠错：海明码

#### 3.1奇偶校验

* 奇偶校验是一种简单的错误检测方法，常用于数据传输中。它通过**增加一个校验位来确保数据中1的个数为奇数或偶数**，从而判断数据在传输过程中是否出错。

* 奇偶校验的类型
  
  * **奇校验**：确保数据中1的个数为奇数。如果1的个数为偶数，校验位为1；否则为0。
  
  * **偶校验**：确保数据中1的个数为偶数。如果1的个数为奇数，校验位为1；否则为0。

* 示例  
  假设传输的数据为**1011001**：

* 奇校验：
  
  * 数据中1的个数为4（偶数），因此校验位为1，传输的数据为10110011。

* 偶校验：
  
  * 数据中1的个数为4（偶数），因此校验位为0，传输的数据为10110010。

#### 3.2、crc循环冗余校验

[bilibili网站上的CRC计算，看完就可以了，很简单，视频不长](https://www.bilibili.com/video/BV12e411F7fd/?spm_id_from=333.337.search-card.all.click&vd_source=c6d25b8c148a15b1c45b8da5d613a042)
三、Ethernet V2
-------------

### 1、概述

* 为了能够检测正在发送的帧是否产生了冲突，以太网的帧至少要64字节。
* 用交换机组建的网络，已经支持**全双工通信**，**不需要再使用CSMA/CD协议**，它传输的帧依然是**以太网帧** 。

### 2、Ethernet V2帧格式

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/e9b17833c7034f528fbc794868237356.png)  
以太网帧的数据长度：46 ~ 1500字节  
以太网帧的长度：64 ~ 1518字节

> 当数据部分的长度**小于46字节**时  
> 数据链路层会在数据的后面加入⼀些**字节填充**，  
> **接收端则会将添加的字节去掉** 。

### 3、以太网MAC帧协议

接收方可能收到的无效MAC帧包括以下几种：  
①：MAC帧的长度不是整数个字节  
②：通过MAC帧的FCS字段的值检测出帧有误码  
③：MAC帧的长度不在64 ~ 1518字节之间

接收方收到**无效的MAC帧**时，就简单**将其丢弃**，以太网的**数据链路层没有重传机制**。
四、PPP协议
-------

### 1、概述

* 点对点协议（Point-to-Point Protocol，PPP）是目前使用最广泛的点对点数据链路层协议。
* 点对点协议主要有**2种应用**：
  * 因特网用户
  * 广域网路由器链路

### 2、PPP帧格式

![在这里插入图片描述](https://i-blog.csdnimg.cn/direct/693723ec579c4c7b833a9d5b783a85b1.png)

本文转自 <https://blog.csdn.net/2401_82911768/article/details/145763552?spm=1001.2014.3001.5502>，如有侵权，请联系删除。


